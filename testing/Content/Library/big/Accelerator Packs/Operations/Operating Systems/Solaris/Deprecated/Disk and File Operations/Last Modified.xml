<?xml version="1.0" encoding="UTF-8"?>
<operation id="a80833d4-3b6b-4977-a61f-c3f92015b114">
  <descriptionCdata><![CDATA[a80833d4-3b6b-4977-a61f-c3f92015b114.description=<pre>\nThis operation checks a file to see if it was modified more recently than the threshold that is specified.\n\nInputs\:\n\thost\:           host name to check\n\tusername\:       user name to login into host as\n\tpassword\:       password to use for login\n\tthreshold\:      length of time to check against (in minutes)\n\tdir\:            directory to check (must end with a '/')\n\tfile\:           filename to check\n\nResponses\:\n\trecently modified\:    If the file was modified recently\n\tnot recently modified\: If the file was not modified recently\n\thost not found\:\t      If the host cannot be found\n\tauthentication failed\: If the login fails\n\tfailure\:               Any other error condition\n\tfile not found\: File could not be found.\n\nResults and Context\:\n\tThe minutes since last modify is placed into the operation result\n\tThe minutes since last modify is placed into the context variable "minutesSinceChange"\n</pre>
]]></descriptionCdata>
  <annotation>a80833d4-3b6b-4977-a61f-c3f92015b114.description</annotation>
  <name>Last Modified</name>
  <categories/>
  <inputs>
    <userInputBinding id="de85d371-f557-4632-a53a-292827bbb797">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>host</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="ecc9bc54-32fe-4f71-8bda-3111e7ac5d1b">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>username</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="e32911c6-d342-4d46-aea9-ce96ff51661d">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>ENCRYPTED</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>password</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="99c5f4bb-19cd-4f70-8608-32c625695083">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>threshold</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="e9753888-fc44-48f4-acdd-a3ec482d68fc">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>dir</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="ef30897b-0e5e-4a09-b682-5a74c34e7fa3">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>file</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="405c8897-3f8a-488c-9936-38f1bf43c3f9">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Environment</inputSymbol>
      <listDelimiter></listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="6248c2c5-ff92-4319-9f56-03328cab2574">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>User</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>${username}</value>
      <record>false</record>
    </staticBinding>
    <staticBinding id="66664697-f96d-4d00-b155-db70fc5c1fd5">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Command</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>ls -E ${dir}${file}</value>
      <record>false</record>
    </staticBinding>
    <userInputBinding id="e20dfdae-f2be-4567-ac4e-a617af972264">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Argument</inputSymbol>
      <listDelimiter></listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="2ba1adf0-ea69-4f65-8f07-abae050a994c">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Host</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>${host}</value>
      <record>false</record>
    </staticBinding>
    <userInputBinding id="0cf0f75f-39da-47c3-b128-c247515b4635">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Private_Key_File</inputSymbol>
      <listDelimiter></listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="02fe3c8e-b5e6-42d0-aa13-f5be4acf0cae">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>ENCRYPTED</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Password</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>{OBFUSCATED}SqstnSxglAP4D4gm72ILRw==</value>
      <record>false</record>
    </staticBinding>
    <staticBinding id="e1694459-e1ac-4c4d-8d09-e81255c1a4e5">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Pty</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>false</value>
      <record>false</record>
    </staticBinding>
  </inputs>
  <scriptlet id="01b864c1-faf9-4607-a26e-1017eed7e67e">
    <annotation></annotation>
    <name>Operation Last Modified (9cf27361-fe6e-44ed-bd7a-8c6da1c30890)</name>
    <script>/*
   This operation uses stat to determine the last modified time of a file
   This is compared with the current time to determine how many minutes have passed since
   the file was last modified.  This value is compared with a threshold.

   The number of minutes since the file was changed is placed in the context minutesSinceChange

   Returns:
	&quot;Recently Modified&quot; if time is under the Threshold
	&quot;Not Recently Modified&quot; if the time is over the Threshold
	&quot;File Not Found&quot; if we can&apos;t stat the file
	&quot;Host Not Found&quot; if we failed to find the host
	&quot;Authentication Failure&quot; if we found the host but couldn&apos;t log in
	&quot;Failed&quot; if there is any other error condition
*/

// set up defaults
scriptletResult = &quot;-1&quot;;
scriptletResponse = &quot;failure&quot;;

// get the command output data
data = scriptletRawResult[&apos;Output String&apos;];

// get the return code
code = parseInt(scriptletRawResult[&apos;Code&apos;]);

// make sure the command executed correctly
if (code == 0) {

	// find the last modify time and parse out the fields
	modifyLine = data.match(/(\d\d\d\d)(-)(\d*)(-)(\d*)(\s+)(\d*)(:)(\d*)(:)(\d*)(.)(\d*)(\s+)(.*)/);

	// parse the modify line if it exists
	if (modifyLine != null) {
		year = modifyLine[1];
		month = modifyLine[3];
		day = modifyLine[5];
		hour = modifyLine[7];
		minute = modifyLine[9];
		seconds = modifyLine[11];

		// month is zero based so fix it up
		mon = parseInt(month);
		if (mon &gt; 0) mon--;
		month = mon.toString();	
		// create a date object of the file last modify time
		when = new Date(year, month, day, hour, minute, seconds);
		// create a date object for the current time
		now = new Date();
		// how long has it been?
		difference = now - when;
		// convert to minutes
		diffMinutes = difference / 60000;
		// store the difference
		scriptletContext.putGlobal(&quot;minutesSinceChange&quot;,diffMinutes.toString());
		scriptletResult = diffMinutes.toString();

		// is this below our time threshold?
		if (diffMinutes &lt;= parseInt(threshold)) {
			scriptletResponse = &quot;recently modified&quot;;
		}
		else {
			scriptletResponse = &quot;not recently modified&quot;;
		}
	}
	else { 
		// the modify line doesn&apos;t exist so the file isn&apos;t there
		scriptletResponse = &quot;file not found&quot;;
	}
}
else
{
	// check for a host not found
	errorstring = scriptletRawResult[&apos;Error String&apos;];
	if (errorstring.match(/.*UnknownHost.*/) != null) {
		scriptletResponse = &quot;host not found&quot;;
	}
	// look for an authentication error
	else if (errorstring.match(/.*Authentication failure.*/) != null) {
		scriptletResponse = &quot;authentication failure&quot;;
	}
	// generic error response
	else {
		scriptletResponse = &quot;failure&quot;;
	}
}

</script>
    <type>RHINO</type>
  </scriptlet>
  <possibleResponses>
    <opResponse id="2882489b-dae2-49b9-982e-e7b8feb55467">
      <annotation></annotation>
      <name>recently modified</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="65f8c18f-17df-4789-a376-63c28233c894">
      <annotation></annotation>
      <name>not recently modified</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="ba011bcc-015a-42ab-a2ad-673beaf3b417">
      <annotation></annotation>
      <name>host not found</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="dad25b3e-24f9-4ed3-b516-8db7e19d91c6">
      <annotation></annotation>
      <name>authentication failed</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="9c99595b-48b6-4438-86ba-05cc73317a23">
      <annotation></annotation>
      <name>file not found</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="b8276a97-e83d-4727-93d1-2ba35e887f78">
      <annotation></annotation>
      <name>failure</name>
      <isDefault>true</isDefault>
      <onFailure>false</onFailure>
      <type>ERROR</type>
      <matchRules/>
    </opResponse>
  </possibleResponses>
  <availableResultExpressions/>
  <resultExpression id="d60ed160-007a-46ce-b5f6-1790f1940395">
    <annotation></annotation>
    <name>Code</name>
    <fieldName>Code</fieldName>
    <sourceType>RAWRESULT</sourceType>
    <filters/>
  </resultExpression>
  <iconSpec id="9df89f0d-c5c5-4f98-b858-cc56c5e5acda">
    <baseIcon>ssh.png</baseIcon>
    <basePath>System</basePath>
    <readOnly>false</readOnly>
    <layers/>
  </iconSpec>
  <opRef>
    <refId>46c0f7ea-a981-4ddc-bcaf-d4faed7af0b6</refId>
  </opRef>
  <fieldValues/>
  <groupAliasRef>
    <refId>5233030c-af46-432b-a682-b326ca6bf2ae</refId>
    <refName>RAS_Operator_Path</refName>
  </groupAliasRef>
  <overrideGroupAlias>${overrideJRAS}</overrideGroupAlias>
</operation>