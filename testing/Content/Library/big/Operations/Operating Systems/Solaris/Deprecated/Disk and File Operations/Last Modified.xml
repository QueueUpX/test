<?xml version="1.0" encoding="UTF-8"?>
<operation id="c6239281-6605-4acd-96fc-add9cf1f7d3f">
  <descriptionCdata><![CDATA[c6239281-6605-4acd-96fc-add9cf1f7d3f.description=<pre>\nThis operation checks a file to see if it was modified more recently than the threshold that is specified.\n\nInputs\:\n\thost\:           host name to check\n\tusername\:       user name to login into host as\n\tpassword\:       password to use for login\n\tthreshold\:      length of time to check against (in minutes)\n\tdir\:            directory to check (must end with a '/')\n\tfile\:           filename to check\n\nResponses\:\n\trecently modified\:    If the file was modified recently\n\tnot recently modified\: If the file was not modified recently\n\thost not found\:\t      If the host cannot be found\n\tauthentication failed\: If the login fails\n\tfailure\:               Any other error condition\n\tfile not found\: File could not be found.\n\nResults and Context\:\n\tThe minutes since last modify is placed into the operation result\n\tThe minutes since last modify is placed into the context variable "minutesSinceChange"\n</pre>
]]></descriptionCdata>
  <annotation>c6239281-6605-4acd-96fc-add9cf1f7d3f.description</annotation>
  <name>Last Modified</name>
  <categories/>
  <inputs>
    <userInputBinding id="f9d431a1-a94a-40d0-b06c-375e6292776e">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>host</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="c6af82ec-8691-4896-b99a-d9cb76fcb50c">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>username</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="5b21d453-637b-4f63-b932-5784322d210a">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>ENCRYPTED</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>password</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="9c498d55-27e1-41e3-8ccf-e63bbb6a3186">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>threshold</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="76f7c31b-7484-411a-aa59-c7c10a0d2d88">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>dir</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="85d99abe-2939-433d-b28c-2af6eaa1bfd5">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>file</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <userInputBinding id="0af809d9-97f6-41c2-bcc9-10e9c9cf33d1">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Environment</inputSymbol>
      <listDelimiter></listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="da09a3b4-dbaf-406a-8936-abc31e5b846b">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>User</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>${username}</value>
      <record>false</record>
    </staticBinding>
    <staticBinding id="82c8e96c-3a8c-4686-8936-7285a8189263">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Command</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>ls -E ${dir}${file}</value>
      <record>false</record>
    </staticBinding>
    <userInputBinding id="934550c3-8076-45b6-aa43-3e5e722ea107">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Argument</inputSymbol>
      <listDelimiter></listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="8f7f8211-3112-4494-a96b-2b90494496b7">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Host</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>${host}</value>
      <record>false</record>
    </staticBinding>
    <userInputBinding id="e5b1b527-052d-4fa7-8501-4583ac06466c">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Private_Key_File</inputSymbol>
      <listDelimiter></listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="713b715d-b129-4128-bb1b-23e8c05e6f35">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>ENCRYPTED</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Password</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>{OBFUSCATED}SqstnSxglAP4D4gm72ILRw==</value>
      <record>false</record>
    </staticBinding>
    <staticBinding id="19e8e26f-55bd-4e2c-8cbc-025602859f3a">
      <annotation></annotation>
      <toContextKey></toContextKey>
      <fromContextKey></fromContextKey>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <recordKey></recordKey>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>Pty</inputSymbol>
      <listDelimiter></listDelimiter>
      <value>false</value>
      <record>false</record>
    </staticBinding>
  </inputs>
  <scriptlet id="7c0b9045-03d1-4dfd-8ee3-45c061b023a9">
    <annotation></annotation>
    <name>Operation Last Modified (9cf27361-fe6e-44ed-bd7a-8c6da1c30890)</name>
    <script>/*
   This operation uses stat to determine the last modified time of a file
   This is compared with the current time to determine how many minutes have passed since
   the file was last modified.  This value is compared with a threshold.

   The number of minutes since the file was changed is placed in the context minutesSinceChange

   Returns:
	&quot;Recently Modified&quot; if time is under the Threshold
	&quot;Not Recently Modified&quot; if the time is over the Threshold
	&quot;File Not Found&quot; if we can&apos;t stat the file
	&quot;Host Not Found&quot; if we failed to find the host
	&quot;Authentication Failure&quot; if we found the host but couldn&apos;t log in
	&quot;Failed&quot; if there is any other error condition
*/

// set up defaults
scriptletResult = &quot;-1&quot;;
scriptletResponse = &quot;failure&quot;;

// get the command output data
data = scriptletRawResult[&apos;Output String&apos;];

// get the return code
code = parseInt(scriptletRawResult[&apos;Code&apos;]);

// make sure the command executed correctly
if (code == 0) {

	// find the last modify time and parse out the fields
	modifyLine = data.match(/(\d\d\d\d)(-)(\d*)(-)(\d*)(\s+)(\d*)(:)(\d*)(:)(\d*)(.)(\d*)(\s+)(.*)/);

	// parse the modify line if it exists
	if (modifyLine != null) {
		year = modifyLine[1];
		month = modifyLine[3];
		day = modifyLine[5];
		hour = modifyLine[7];
		minute = modifyLine[9];
		seconds = modifyLine[11];

		// month is zero based so fix it up
		mon = parseInt(month);
		if (mon &gt; 0) mon--;
		month = mon.toString();	
		// create a date object of the file last modify time
		when = new Date(year, month, day, hour, minute, seconds);
		// create a date object for the current time
		now = new Date();
		// how long has it been?
		difference = now - when;
		// convert to minutes
		diffMinutes = difference / 60000;
		// store the difference
		scriptletContext.putGlobal(&quot;minutesSinceChange&quot;,diffMinutes.toString());
		scriptletResult = diffMinutes.toString();

		// is this below our time threshold?
		if (diffMinutes &lt;= parseInt(threshold)) {
			scriptletResponse = &quot;recently modified&quot;;
		}
		else {
			scriptletResponse = &quot;not recently modified&quot;;
		}
	}
	else { 
		// the modify line doesn&apos;t exist so the file isn&apos;t there
		scriptletResponse = &quot;file not found&quot;;
	}
}
else
{
	// check for a host not found
	errorstring = scriptletRawResult[&apos;Error String&apos;];
	if (errorstring.match(/.*UnknownHost.*/) != null) {
		scriptletResponse = &quot;host not found&quot;;
	}
	// look for an authentication error
	else if (errorstring.match(/.*Authentication failure.*/) != null) {
		scriptletResponse = &quot;authentication failure&quot;;
	}
	// generic error response
	else {
		scriptletResponse = &quot;failure&quot;;
	}
}

</script>
    <type>RHINO</type>
  </scriptlet>
  <possibleResponses>
    <opResponse id="034214e1-f9ca-45b0-b14f-4fa29df40cc6">
      <annotation></annotation>
      <name>recently modified</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="8d457663-c0cf-410e-a3a0-818f300a0106">
      <annotation></annotation>
      <name>not recently modified</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="317d7f42-57b2-42db-8aa1-5a6d293e08b3">
      <annotation></annotation>
      <name>host not found</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="3e7e8dda-6077-4387-a3bf-e4c3f85aeb85">
      <annotation></annotation>
      <name>authentication failed</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="29da0141-83d6-4043-bcf4-74189a4da649">
      <annotation></annotation>
      <name>file not found</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>NO_ACTION_TAKEN</type>
      <matchRules/>
    </opResponse>
    <opResponse id="93809628-c537-4f65-acfb-fd97d3ef7be2">
      <annotation></annotation>
      <name>failure</name>
      <isDefault>true</isDefault>
      <onFailure>false</onFailure>
      <type>ERROR</type>
      <matchRules/>
    </opResponse>
  </possibleResponses>
  <availableResultExpressions/>
  <resultExpression id="9b181447-239f-41ad-a81e-dea5b6e59338">
    <annotation></annotation>
    <name>Code</name>
    <fieldName>Code</fieldName>
    <sourceType>RAWRESULT</sourceType>
    <filters/>
  </resultExpression>
  <iconSpec id="c438ec83-d18a-446d-b3fe-7af1cb6a3d1f">
    <baseIcon>ssh.png</baseIcon>
    <basePath>System</basePath>
    <readOnly>false</readOnly>
    <layers/>
  </iconSpec>
  <opRef>
    <refId>46c0f7ea-a981-4ddc-bcaf-d4faed7af0b6</refId>
  </opRef>
  <fieldValues/>
  <groupAliasRef>
    <refId>5233030c-af46-432b-a682-b326ca6bf2ae</refId>
    <refName>RAS_Operator_Path</refName>
  </groupAliasRef>
  <overrideGroupAlias>${overrideJRAS}</overrideGroupAlias>
</operation>