<?xml version="1.0" encoding="UTF-8"?>
<operation id="88bca5d4-6bb6-4320-8180-4a662edec0c7">
  <descriptionCdata><![CDATA[88bca5d4-6bb6-4320-8180-4a662edec0c7.0daf5303-e986-4168-a42e-9544b06ee34b.prompt=HostName\:
88bca5d4-6bb6-4320-8180-4a662edec0c7.description=<pre>\nThis flow traces the route from a Windows host to a target host.\n\nInputs\:\nhost - The host to traceroute from.\nusername - Username to use for remote WMI impersonation and thread impersonation on the RAS host for this operation (can be left blank).\npassword - Password of the user.\ntarget - The host to traceroute to.\nmax_hops - The maximum number of hops to traceroute over.\ncommand - DO NOT CHANGE\!\!\!\noutputPath - A network accessible path used by the operation to store temporary files. If not specified it points to \\\\host\\admin$\\temp\\'. If this path is not accessible you should change it to use another share that the host local system account has write access to. By default, the path will have to be  changed on Windows 2000 systems.\n\nResponses\:\nsuccess - The traceroute completed.\nUnknown Target - Target could not be resolved to an ip address.\nConnection Error - An error occurred while connecting to host.\n\nExtra Results\:\naddress - The actual ip address trace-routed to.\nhops - The hops along the route.\ntimes - The response time (in milliseconds) of each hop.\n</pre>
]]></descriptionCdata>
  <annotation>88bca5d4-6bb6-4320-8180-4a662edec0c7.description</annotation>
  <name>Trace Route</name>
  <categories/>
  <inputs>
    <userInputBinding id="0daf5303-e986-4168-a42e-9544b06ee34b">
      <annotation></annotation>
      <assignFromContext>true</assignFromContext>
      <assignToContext>true</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>host</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt>88bca5d4-6bb6-4320-8180-4a662edec0c7.0daf5303-e986-4168-a42e-9544b06ee34b.prompt</prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="f8fd0381-e268-4fbc-badd-addfcfeb0f16">
      <annotation></annotation>
      <fromContextKey>username</fromContextKey>
      <assignFromContext>true</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>user</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <value></value>
      <record>false</record>
    </staticBinding>
    <staticBinding id="651d7853-e1d6-4b10-be8d-79587d70a8a5">
      <annotation></annotation>
      <assignFromContext>true</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>ENCRYPTED</inputType>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>password</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <value></value>
      <record>false</record>
    </staticBinding>
    <userInputBinding id="434894c4-7422-4cf6-b133-87ef867f8290">
      <annotation></annotation>
      <assignFromContext>true</assignFromContext>
      <assignToContext>true</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>target</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <record>false</record>
      <prompt></prompt>
      <isMultiSelect>false</isMultiSelect>
      <sourceDelimiter>|</sourceDelimiter>
    </userInputBinding>
    <staticBinding id="479afb4e-4ace-4d76-9504-0d59b0bc0865">
      <annotation></annotation>
      <assignFromContext>true</assignFromContext>
      <assignToContext>true</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>max_hops</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <value>30</value>
      <record>false</record>
    </staticBinding>
    <staticBinding id="5e4d81dc-7005-46e9-8e5d-9a5a2bfa586d">
      <annotation></annotation>
      <assignFromContext>false</assignFromContext>
      <assignToContext>false</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>true</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>command</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <value>tracert -h ${max_hops} ${target}</value>
      <record>false</record>
    </staticBinding>
    <staticBinding id="d5abca9c-3506-450a-82c6-ba68ab7f2006">
      <annotation></annotation>
      <assignFromContext>true</assignFromContext>
      <assignToContext>true</assignToContext>
      <inputType>STRING</inputType>
      <isList>false</isList>
      <required>false</required>
      <isPersisted>true</isPersisted>
      <inputSymbol>outputPath</inputSymbol>
      <listDelimiter>,</listDelimiter>
      <value></value>
      <record>false</record>
    </staticBinding>
  </inputs>
  <scriptlet id="d9b1f459-3ea2-44dc-8071-4bbdc6af2752">
    <annotation></annotation>
    <name>Operation Trace Route (5c4df5a4-c35a-45ee-94e0-fd376619587a)</name>
    <script>sErr = scriptletRawResult[&quot;StdErr&quot;];
sOut = scriptletRawResult[&quot;StdOut&quot;];

if (sErr.length &gt; 0)
{
   scriptletResult = sErr;
   if (sErr != sOut)
   {
      scriptletResult = scriptletResult + sOut;
   }
}
else
{
   scriptletResult = sOut;
}</script>
    <type>RHINO</type>
  </scriptlet>
  <possibleResponses>
    <opResponse id="3bb648be-dc4f-4131-9dca-90c42facfcca">
      <annotation></annotation>
      <name>Unknown Target</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>ERROR</type>
      <matchRules>
        <expression id="333f06c1-0abe-4a59-9457-f4026a87c1ef">
          <annotation></annotation>
          <name>exception</name>
          <fieldName>returnCode</fieldName>
          <sourceType>RAWRESULT</sourceType>
          <containsEvaluator id="f23f38c5-7781-41f1-9b13-017a9a7002f2">
            <annotation></annotation>
            <name>Config Item</name>
            <text>0</text>
            <ignoreCase>true</ignoreCase>
            <matchType>EXACT_MATCH</matchType>
          </containsEvaluator>
          <filters/>
        </expression>
        <expression id="6465b802-1151-47da-85cd-25b8364ed06b">
          <annotation></annotation>
          <name>exception</name>
          <fieldName>StdOut</fieldName>
          <sourceType>RAWRESULT</sourceType>
          <containsEvaluator id="67ed1f86-055e-45d5-8915-6412fee0f3b7">
            <annotation></annotation>
            <name>Config Item</name>
            <text>Unable to resolve target system</text>
            <ignoreCase>true</ignoreCase>
            <matchType>BEGINS_WITH</matchType>
          </containsEvaluator>
          <filters/>
        </expression>
      </matchRules>
    </opResponse>
    <opResponse id="a516d6d4-e2d7-4ada-af86-fb7c5134af30">
      <annotation></annotation>
      <name>success</name>
      <isDefault>false</isDefault>
      <onFailure>false</onFailure>
      <type>RESOLVED</type>
      <matchRules>
        <expression id="7763e954-6078-4e10-85c0-895cf2f9c2f5">
          <annotation></annotation>
          <name></name>
          <fieldName>returnCode</fieldName>
          <sourceType>RAWRESULT</sourceType>
          <containsEvaluator id="0cb7f731-603c-497d-921b-bb5f12bf46c9">
            <annotation></annotation>
            <name>Config Item</name>
            <text>0</text>
            <ignoreCase>true</ignoreCase>
            <matchType>EXACT_MATCH</matchType>
          </containsEvaluator>
          <filters/>
        </expression>
      </matchRules>
    </opResponse>
    <opResponse id="bb85ba22-b99b-422d-ba39-13c88158e962">
      <annotation></annotation>
      <name>Connection Error</name>
      <isDefault>true</isDefault>
      <onFailure>true</onFailure>
      <type>ERROR</type>
      <matchRules>
        <expression id="a9f5e69f-42e6-4ebe-a590-95db2f09dc28">
          <annotation></annotation>
          <name></name>
          <fieldName>returnCode</fieldName>
          <sourceType>RAWRESULT</sourceType>
          <containsEvaluator id="c6c49a89-762b-4616-b7d3-15b7217fa1bd">
            <annotation></annotation>
            <name>Config Item</name>
            <text>1</text>
            <ignoreCase>true</ignoreCase>
            <matchType>EXACT_MATCH</matchType>
          </containsEvaluator>
          <filters/>
        </expression>
      </matchRules>
    </opResponse>
  </possibleResponses>
  <availableResultExpressions>
    <expression id="28b916f9-988c-43bc-8998-1322962e2e5a">
      <annotation></annotation>
      <name>times</name>
      <fieldName>StdOut</fieldName>
      <sourceType>RAWRESULT</sourceType>
      <filters>
        <regexFilter id="a6fa1e28-6c43-4c3f-a180-6b1e6d7b6e15">
          <annotation></annotation>
          <name>RegularExpression</name>
          <expression>(&lt;*\d+\s+ms\s+)+</expression>
          <ignoreCase>false</ignoreCase>
          <regType>JAVA</regType>
          <entireString>false</entireString>
          <multiLine>true</multiLine>
        </regexFilter>
        <replaceAllFilter id="025b1c5c-0225-45fb-8130-04880430e197">
          <annotation></annotation>
          <name>Replace All</name>
          <ignoreCase>false</ignoreCase>
          <searchString>ms</searchString>
          <replaceString>,</replaceString>
          <replaceType>ALL</replaceType>
        </replaceAllFilter>
        <replaceAllFilter id="ee262c7a-2590-4d64-98f2-994388422d17">
          <annotation></annotation>
          <name>Replace All</name>
          <ignoreCase>false</ignoreCase>
          <searchString> </searchString>
          <replaceType>ALL</replaceType>
        </replaceAllFilter>
        <replaceAllFilter id="08744f66-b374-4881-85e7-38dc9f29ed74">
          <annotation></annotation>
          <name>Replace All</name>
          <ignoreCase>false</ignoreCase>
          <searchString>,
</searchString>
          <replaceString>;</replaceString>
          <replaceType>ALL</replaceType>
        </replaceAllFilter>
        <replaceAllFilter id="66532885-63d2-4134-9a6e-10ddfd47295c">
          <annotation></annotation>
          <name>Replace All</name>
          <ignoreCase>false</ignoreCase>
          <searchString>&lt;</searchString>
          <replaceType>ALL</replaceType>
        </replaceAllFilter>
        <regexFilter id="57165b7b-ca5c-420c-bcc1-7d9b7fb1106c">
          <annotation></annotation>
          <name>RegularExpression</name>
          <expression>((\d+,*)+;*)+\d+</expression>
          <ignoreCase>false</ignoreCase>
          <regType>JAVA</regType>
          <entireString>true</entireString>
          <multiLine>false</multiLine>
        </regexFilter>
      </filters>
    </expression>
    <expression id="d6f62ef9-f855-4c3f-b37e-043b8b1db253">
      <annotation></annotation>
      <name>address</name>
      <fieldName>StdOut</fieldName>
      <sourceType>RAWRESULT</sourceType>
      <filters>
        <regexFilter id="a0b079a9-4486-4b22-9429-87eda3c5ed4a">
          <annotation></annotation>
          <name>RegularExpression</name>
          <expression>\d+\.\d+\.\d+\.\d+</expression>
          <ignoreCase>false</ignoreCase>
          <regType>JAVA</regType>
          <entireString>true</entireString>
          <multiLine>false</multiLine>
        </regexFilter>
      </filters>
    </expression>
    <expression id="d5c35fd4-b363-4a25-8046-bc94ebac0787">
      <annotation></annotation>
      <name>hops</name>
      <fieldName>StdOut</fieldName>
      <sourceType>RAWRESULT</sourceType>
      <filters>
        <regexFilter id="faa3267b-f3c0-4ca0-a4b6-451c53479ad3">
          <annotation></annotation>
          <name>RegularExpression</name>
          <expression>\s+\d+\s+(&lt;*\d+\s+ms\s+)+.+\d+\.\d+\.\d+\.\d+</expression>
          <ignoreCase>false</ignoreCase>
          <regType>JAVA</regType>
          <entireString>false</entireString>
          <multiLine>true</multiLine>
        </regexFilter>
        <regexFilter id="d11b85d7-0f78-4003-aaf2-c0d0a618fb55">
          <annotation></annotation>
          <name>RegularExpression</name>
          <expression>\d+\.\d+\.\d+\.\d+</expression>
          <ignoreCase>false</ignoreCase>
          <regType>JAVA</regType>
          <entireString>false</entireString>
          <multiLine>true</multiLine>
        </regexFilter>
        <replaceAllFilter id="8709f325-ffa3-4812-8f06-42a633272139">
          <annotation></annotation>
          <name>Replace All</name>
          <ignoreCase>false</ignoreCase>
          <searchString>
</searchString>
          <replaceString>,</replaceString>
          <replaceType>ALL</replaceType>
        </replaceAllFilter>
      </filters>
    </expression>
  </availableResultExpressions>
  <resultExpression id="4dd8156b-0804-4371-b85f-cab1dd98918f">
    <annotation></annotation>
    <name>exception</name>
    <fieldName>StdOut</fieldName>
    <sourceType>RAWRESULT</sourceType>
    <filters/>
  </resultExpression>
  <iconSpec id="6b2982c1-2589-4c84-b0df-d0b4d6ede4d0">
    <baseIcon>client_network.png</baseIcon>
    <basePath>Networking/</basePath>
    <readOnly>false</readOnly>
    <layers/>
  </iconSpec>
  <opRef>
    <refId>632830d9-d5be-47b3-9768-efa99decb443</refId>
  </opRef>
  <fieldValues/>
  <groupAliasRef>
    <refId>5233030c-af46-432b-a682-b326ca6bf2ae</refId>
    <refName>RAS_Operator_Path</refName>
  </groupAliasRef>
  <overrideGroupAlias>${overrideNRAS}</overrideGroupAlias>
</operation>